# Support Portal ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —Ä–∞–∑–¥–µ–ª—É –ö–ö–¢/–û–§–î –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ—Å—Ç–∞–≤–∞–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å:
- **–ö–Ω–æ–ø–∫–∞ ¬´–ü–æ–ª—É—á–∏—Ç—å –≤–Ω–µ—à–Ω–∏–π IP¬ª** ‚Äî –ø—Ä–∏—á–∏–Ω–∞: –ø–∞–∫–µ—Ç `paramiko` —Å–ª–µ—Ç–∞–ª –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- **–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel** ‚Äî –ø—Ä–∏—á–∏–Ω–∞: –ø–∞–∫–µ—Ç `openpyxl` —Å–ª–µ—Ç–∞–ª –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–†–µ—à–µ–Ω–∏–µ: –¥–æ–±–∞–≤–∏—Ç—å –æ–±–∞ –ø–∞–∫–µ—Ç–∞ –≤ `requirements.txt` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é (—Å–º. —Ä–∞–∑–¥–µ–ª ¬´–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫¬ª).

- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ö–ö–¢ –∑–∞–≤–∏—Å–∞–µ—Ç –∏–ª–∏ –ø–∞–¥–∞–µ—Ç –ø–æ —Ç–∞–π–º–∞—É—Ç—É** ‚Äî –ø—Ä–∏—á–∏–Ω–∞: API `lk.ofd.ru` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ 1 –≤ —Å–µ–∫—É–Ω–¥—É. –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–∞—Å—Å (–¥–æ 700 —à—Ç—É–∫) –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ 13 –º–∏–Ω—É—Ç. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é gunicorn —É–±–∏–≤–∞–ª –≤–æ—Ä–∫–µ—Ä —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã (`--timeout 120`), –∏ subprocess –ø–∞–¥–∞–ª —Ä–∞–Ω—å—à–µ. –†–µ—à–µ–Ω–∏–µ: —É–≤–µ–ª–∏—á–∏—Ç—å `--timeout` –≤ `docker-compose.yml` –¥–æ 1000 –∏ `timeout` subprocess –¥–æ 900 —Å–µ–∫—É–Ω–¥ (—É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏). –°–∫—Ä–∏–ø—Ç `ofd_fetch.sh` —Å–æ–±–ª—é–¥–∞–µ—Ç –ø–∞—É–∑—É 1.1 —Å–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

- **–¢–æ–∫–µ–Ω –û–§–î –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ö–æ–º–ø–∞–Ω–∏–∏¬ª** ‚Äî –ø—Ä–∏—á–∏–Ω–∞: –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ –∫–ª–∞—Å—Å–∞ `OfdCompanyViewSet` –∏–∑ `views.py` –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º —É–¥–∞–ª—è–ª—Å—è –∏–º–ø–æ—Ä—Ç `OfdCompanyWriteSerializer`, –∏–∑-–∑–∞ —á–µ–≥–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤–æ–∑–Ω–∏–∫–∞–ª `NameError` –∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–ª –æ—à–∏–±–∫–æ–π 500.

–†–µ—à–µ–Ω–∏–µ: —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤ `backend/apps/clients/views.py` –≤ –±–ª–æ–∫–µ –∏–º–ø–æ—Ä—Ç–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç `OfdCompanyWriteSerializer`:
```python
from .serializers import (
    ..., OfdCompanySerializer, OfdCompanyWriteSerializer,
)
```
–ò —á—Ç–æ –∫–ª–∞—Å—Å `OfdCompanyViewSet` –≤ —Ñ–∞–π–ª–µ **–æ–¥–∏–Ω** –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç `get_serializer_class`:
```python
class OfdCompanyViewSet(viewsets.ModelViewSet):
    queryset = OfdCompany.objects.all()
    permission_classes = [IsAuthenticated]

    def get_serializer_class(self):
        if self.action in ('create', 'update', 'partial_update'):
            return OfdCompanyWriteSerializer
        return OfdCompanySerializer
```
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º ‚Äî –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1
grep -c "class OfdCompanyViewSet" /opt/support-portal/backend/apps/clients/views.py

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–º–ø–æ—Ä—Ç
grep "OfdCompanyWriteSerializer" /opt/support-portal/backend/apps/clients/views.py

# –ï—Å–ª–∏ –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º
sed -i 's/OfdCompanySerializer,$/OfdCompanySerializer, OfdCompanyWriteSerializer,/' \
  /opt/support-portal/backend/apps/clients/views.py

docker compose restart backend
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**Support Portal** ‚Äî –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (–∞–ø—Ç–µ–∫–∞–º–∏), –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏, —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ –∫–∞—Å—Å–æ–≤–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π (–ö–ö–¢) —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –û–§–î.

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|------------|
| Backend | Django 4.x + Django REST Framework | REST API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Frontend | React 18 + Ant Design | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | PostgreSQL 16 | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| –í–µ–±-—Å–µ—Ä–≤–µ—Ä | Nginx (Alpine) | –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ –∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker + Docker Compose | –ò–∑–æ–ª—è—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ |
| –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ | Node.js 18 + npm | –ö–æ–º–ø–∏–ª—è—Ü–∏—è React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |

---

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏

**üìã –ö–ª–∏–µ–Ω—Ç—ã**
- –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞: –∞–¥—Ä–µ—Å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ), –∫–æ–º–ø–∞–Ω–∏—è, –ò–ù–ù, —Ç–µ–ª–µ—Ñ–æ–Ω, email, –∫–æ–¥ –∞–ø—Ç–µ–∫–∏, ICCID
- –¢—Ä–∏ –≤–∫–ª–∞–¥–∫–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ: **üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**, **üåê –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã**, **üßæ –ö–ö–¢**
- –ë–ª–æ–∫ **–°–µ—Ç—å**: –ø–æ–¥—Å–µ—Ç—å –∞–ø—Ç–µ–∫–∏, –≤–Ω–µ—à–Ω–∏–π IP, –ú–∏–∫—Ä–æ—Ç–∏–∫ IP (–∞–≤—Ç–æ: .1), –°–µ—Ä–≤–µ—Ä IP (–∞–≤—Ç–æ: .2), –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- **–ü—Ä–æ–≤–∞–π–¥–µ—Ä 1 –∏ –ü—Ä–æ–≤–∞–π–¥–µ—Ä 2**: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å –∏–∫–æ–Ω–∫–∞–º–∏), —Ç–∞—Ä–∏—Ñ, –ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç, ‚Ññ –¥–æ–≥–æ–≤–æ—Ä–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- –ü—Ä–∏ —Ç–∏–ø–µ –ú–æ–¥–µ–º –∏–ª–∏ MR-Net: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ù–æ–º–µ—Ä (–º–æ–¥–µ–º/SIM) –∏ ICCID –º–æ–¥–µ–º–∞
- –ü–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —Å –≤—ã–±–æ—Ä–æ–º —Å–ª–æ—Ç–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ IP —Å –ú–∏–∫—Ä–æ—Ç–∏–∫–∞ –ø–æ SSH (paramiko)
- –ó–∞–º–µ—Ç–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å –∏–∫–æ–Ω–∫–∞–º–∏: ‚úèÔ∏è –∏–∑–º–µ–Ω–µ–Ω–∏—è, üñ®Ô∏è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ö–ö–¢, üóëÔ∏è —É–¥–∞–ª–µ–Ω–∏–µ –ö–ö–¢
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ö–ö–¢: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ (–†–ù–ú, —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä, –º–æ–¥–µ–ª—å), —É–¥–∞–ª–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –§–ù
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–¥–æ 5 –ú–ë): —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
- –°–∏—Å—Ç–µ–º–∞ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ (—á–µ—Ä–Ω–æ–≤–∏–∫–∏ —Å—Ç–∞—Ä—à–µ 2 —á–∞—Å–æ–≤ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ Excel —Å –≤—ã–±–æ—Ä–æ–º –ø–æ–ª–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ Email
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ —Ç–∞–±–ª–∏—Ü—ã ‚Äî –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ)

**üßæ –ö–ö–¢ (–ö–∞—Å—Å–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞)**
- –†–∞–∑–¥–µ–ª **¬´–ö–æ–º–ø–∞–Ω–∏–∏¬ª** ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–∞–Ω–∏–π —Å –ò–ù–ù –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º –û–§–î (lk.ofd.ru)
- –í –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–º–ø–∞–Ω–∏–∏ (–≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π –ò–ù–ù –∏ –ö–æ–º–ø–∞–Ω–∏—è)
- –í–∫–ª–∞–¥–∫–∞ **¬´–ö–ö–¢¬ª** –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞:
  - –ü—Ä–æ—Å–º–æ—Ç—Ä: –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å –ø–æ –†–ù–ú¬ª (–±—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ö–ö–¢), –∫–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –ö–ö–¢
  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ö–ö–¢ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) + –∫–Ω–æ–ø–∫–∏ ¬´–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ö–ö–¢ –ø–æ –ò–ù–ù¬ª –∏ ¬´–û–±–Ω–æ–≤–∏—Ç—å –ø–æ –†–ù–ú¬ª
  - –°–æ–∑–¥–∞–Ω–∏–µ: –ø–æ–ª—è –¥–ª—è –≤–≤–æ–¥–∞ –†–ù–ú (—Å –∫–Ω–æ–ø–∫–∞–º–∏ + –∏ ‚àí), –∫–Ω–æ–ø–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ –ò–ù–ù –∏ –ø–æ –†–ù–ú
- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –ø–æ–ª—è –ö–ö–¢: –†–ù–ú, —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä, –º–æ–¥–µ–ª—å, –Ω–æ–º–µ—Ä –§–ù, –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –∫–æ–Ω–µ—Ü —Å—Ä–æ–∫–∞ –§–ù, –∫–æ–Ω–µ—Ü –¥–æ–≥–æ–≤–æ—Ä–∞ –û–§–î, –∞–¥—Ä–µ—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç `ofd_fetch.sh`, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–π –Ω–∞ **—Ö–æ—Å—Ç–µ** (–∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ö–ö–¢ –ø–æ –∞–¥—Ä–µ—Å—É –∞–ø—Ç–µ–∫–∏ —Å —Ç–æ—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–æ–º–µ—Ä–∞ –¥–æ–º–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ –†–ù–ú ‚Äî –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –†–ù–ú –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –∞–¥—Ä–µ—Å–∞ –≤ —á–µ—Ä–Ω–æ–≤–∏–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞

**üåê –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã**
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–µ–ª–µ—Ñ–æ–Ω—ã —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É

**üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏**
- RBAC: —Ä–æ–ª–∏ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –†–æ–ª–∏: **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**, **–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**, **–°–≤—è–∑–∏—Å—Ç**
- –ü–æ–ª–µ **–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –¥–µ–∂—É—Ä—Å—Ç–≤
- –†–æ–ª—å **–°–≤—è–∑–∏—Å—Ç**: –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑–¥–µ–ª–∞–º –ö–ª–∏–µ–Ω—Ç—ã –∏ –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã, –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–µ–∂—É—Ä—Å—Ç–≤**
- –¢–∞–±–ª–∏—Ü–∞: —Å—Ç—Ä–æ–∫–∏ ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (–±–µ–∑ –°–≤—è–∑–∏—Å—Ç–æ–≤), —Å—Ç–æ–ª–±—Ü—ã ‚Äî –¥–Ω–∏ –º–µ—Å—è—Ü–∞
- –¢–∏–ø—ã –¥–µ–∂—É—Ä—Å—Ç–≤ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –º–∞—Ä–∫–∏—Ä–æ–≤–∫–æ–π: –¢–µ–ª–µ—Ñ–æ–Ω (–∑–µ–ª—ë–Ω—ã–π), –†–∞–±–æ—Ç–∞ –¥–Ω—ë–º (—Å–∏–Ω–∏–π), –¢–µ–ª–µ—Ñ–æ–Ω + –¥–µ–Ω—å (–∑–µ–ª—ë–Ω—ã–π), –û—Ç–ø—É—Å–∫ (–∂—ë–ª—Ç—ã–π), –ó–∞–Ω—è—Ç (–∫—Ä–∞—Å–Ω—ã–π)
- –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –≤—ã–¥–µ–ª—è—é—Ç—Å—è –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø–æ–º–µ—Ç–∏—Ç—å –ª—é–±–æ–π –¥–µ–Ω—å –∫–∞–∫ –≤—ã—Ö–æ–¥–Ω–æ–π –∏–ª–∏ —Ä–∞–±–æ—á–∏–π
- –î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è —Ä–æ–∑–æ–≤–æ–π —Ä–∞–º–∫–æ–π —Å üéÇ
- **–ú—É–ª—å—Ç–∏–≤—ã–¥–µ–ª–µ–Ω–∏–µ**: Ctrl+–∫–ª–∏–∫ –ø–æ –ª—é–±—ã–º —è—á–µ–π–∫–∞–º (–∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –∏ –¥–Ω–µ–π) –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ ‚Äî –æ—Ç–º–µ—á–∞—é—Ç—Å—è —Å–∏–Ω–∏–º —Å –≥–∞–ª–æ—á–∫–æ–π; –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å ¬´–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–∏–ø‚Ä¶¬ª –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º; Esc –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π Ctrl+–∫–ª–∏–∫ —Å–Ω–∏–º–∞–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ
- –ö–Ω–æ–ø–∫–∞ **–û—Ç—á—ë—Ç –∑–∞ –º–µ—Å—è—Ü** ‚Äî —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–Ω–µ–π –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- –ö–Ω–æ–ø–∫–∞ **–û—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É** (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)

**üîÑ –ó–∞–º–µ–Ω–∞ –§–ù**
- –†–∞–∑–¥–µ–ª –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å—Ä–æ–∫–æ–≤ –∑–∞–º–µ–Ω—ã —Ñ–∏—Å–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–µ–π
- –í–∫–ª–∞–¥–∫–∞ **–û–±—â–∏–π** ‚Äî –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ö–ö–¢ –∏–∑ –±–∞–∑—ã —Å –ø–æ–∏—Å–∫–æ–º, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º, –≤—ã–≥—Ä—É–∑–∫–æ–π –≤ Excel (—Ñ–∞–π–ª –∏–ª–∏ –Ω–∞ –ø–æ—á—Ç—É), –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –≤–∏–¥–∏–º—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ –∏ –≤—ã–±–æ—Ä–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- –í–∫–ª–∞–¥–∫–∞ **–ü–æ –º–µ—Å—è—Ü–∞–º** ‚Äî —Ç–µ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –Ω–æ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –º–µ—Å—è—Ü—É –∏ –≥–æ–¥—É –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞ –§–ù; –≤—ã–±–æ—Ä –º–µ—Å—è—Ü–∞ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –∏–ª–∏ –¥–∞—Ç–∞–ø–∏–∫–µ—Ä–æ–º; —Å—á—ë—Ç—á–∏–∫ –ö–ö–¢ —Ç—Ä–µ–±—É—é—â–∏—Ö –∑–∞–º–µ–Ω—ã
- –ö–æ–ª–æ–Ω–∫–∏: –ê–¥—Ä–µ—Å, –ö–æ–º–ø–∞–Ω–∏—è, –†–ù–ú, –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä, –ù–æ–º–µ—Ä –§–ù, –ö–æ–Ω–µ—Ü —Å—Ä–æ–∫–∞ –§–ù, –ö–æ–Ω–µ—Ü –¥–æ–≥–æ–≤–æ—Ä–∞ –û–§–î
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –¥–∞—Ç: –∫—Ä–∞—Å–Ω–∞—è (–ø—Ä–æ—Å—Ä–æ—á–µ–Ω), –æ—Ä–∞–Ω–∂–µ–≤–∞—è (‚â§30 –¥–Ω–µ–π), –∂—ë–ª—Ç–∞—è (‚â§90 –¥–Ω–µ–π)
- –ö–ª–∏–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ (–∞–¥—Ä–µ—Å—É) ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –≤ –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞ —Å—Ä–∞–∑—É –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ö–ö–¢

**‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
- SSH-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ú–∏–∫—Ä–æ—Ç–∏–∫–∞–º (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å —à–∏—Ñ—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Fernet)
- SMTP-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ Email (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å —à–∏—Ñ—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Fernet)
- –ö–Ω–æ–ø–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞
- –ö–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
- –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø—É–Ω–∫—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

- Ubuntu 20.04 / 22.04 / 24.04
- 2 –ì–ë RAM –º–∏–Ω–∏–º—É–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4 –ì–ë)
- 20 –ì–ë –¥–∏—Å–∫–∞
- –û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 80 (–∏ 443 –ø—Ä–∏ HTTPS)

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 1.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
apt update && apt upgrade -y
```

### 1.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

```bash
curl -fsSL https://get.docker.com | sh
```

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose Plugin

```bash
apt install docker-compose-plugin -y
```

### 1.4 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git

```bash
apt install git -y
```

### 1.5 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python 3 –∏ pip

Python –Ω—É–∂–µ–Ω –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –û–§–î –Ω–∞ —Ö–æ—Å—Ç–µ.

```bash
apt install python3 python3-pip -y
```

### 1.6 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ cryptography

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `ENCRYPTION_KEY` ‚Äî Fernet-–∫–ª—é—á–∞, –∫–æ—Ç–æ—Ä—ã–º —à–∏—Ñ—Ä—É—é—Ç—Å—è SSH-–ø–∞—Ä–æ–ª—å, SMTP-–ø–∞—Ä–æ–ª—å –∏ —Ç–æ–∫–µ–Ω—ã –û–§–î –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```bash
pip3 install cryptography --break-system-packages
```

### 1.7 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js –∏ npm

Node.js –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (20‚Äì40 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 5‚Äì10 –º–∏–Ω –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ Docker).

```bash
apt install nodejs npm -y
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏–∏:

```bash
node --version   # v18.x.x –∏–ª–∏ –≤—ã—à–µ
npm --version    # 9.x.x –∏–ª–∏ –≤—ã—à–µ
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑):

```bash
cd /opt/support-portal/frontend
npm install
```

### 1.8 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

```bash
apt install curl nano iputils-ping openssl -y
```

### 1.9 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
docker --version
docker compose version
git --version
python3 --version
node --version
npm --version
ping -c1 8.8.8.8
```

---

## 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–µ–∫—Ç

```bash
git clone https://github.com/suminslava55-droid/support-portal-new.git /opt/support-portal
cd /opt/support-portal
```

---

## 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
nano .env
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `.env`:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_NAME=support_portal
DB_USER=postgres
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_HOST=db
DB_PORT=5432

# Django
SECRET_KEY=CHANGE_ME_VERY_LONG_SECRET_KEY_HERE
DEBUG=False
ALLOWED_HOSTS=your-ip-or-domain,localhost
CORS_ALLOWED_ORIGINS=http://your-ip-or-domain,http://localhost

# –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–¥–ª—è SSH, SMTP –ø–∞—Ä–æ–ª–µ–π –∏ —Ç–æ–∫–µ–Ω–æ–≤ –û–§–î)
ENCRYPTION_KEY=CHANGE_ME_FERNET_KEY
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π

**SECRET_KEY:**
```bash
openssl rand -hex 50
```

**ENCRYPTION_KEY** (Fernet-–∫–ª—é—á):
```bash
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

> ‚ö†Ô∏è **–ü–æ—Ç–µ—Ä—è ENCRYPTION_KEY = –ø–æ—Ç–µ—Ä—è –≤—Å–µ—Ö –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –∏ —Ç–æ–∫–µ–Ω–æ–≤ –û–§–î.** –î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é `.env`.

### –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ .env

```env
DB_NAME=support_portal
DB_USER=postgres
DB_PASSWORD=qX7!mN3kP9@support
DB_HOST=db
DB_PORT=5432

SECRET_KEY=a3f8c2d1e4b7a9f0c3d6e2b5a8f1c4d7e0b3a6f9c2d5e8b1a4f7c0d3e6b9a2f5c8d1e4b7
DEBUG=False
ALLOWED_HOSTS=94.130.1.1,localhost
CORS_ALLOWED_ORIGINS=http://94.130.1.1,http://localhost

ENCRYPTION_KEY=ySKoI9K2_Uj2qjNUSxREYTFIW3o-HILiIMYZ5enMgYs=
```

> **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ nano:** `Ctrl+O` ‚Üí `Enter` ‚Üí `Ctrl+X`

---

## 4. –•—Ä–∞–Ω–∏–ª–∏—â–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤

```bash
mkdir -p /opt/support-portal/media
```

---

## 5. –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –û–§–î (–Ω–∞ —Ö–æ—Å—Ç–µ)

–°–∫—Ä–∏–ø—Ç `ofd_fetch.sh` –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç –û–§–î. –ò–∑ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É, –ø–æ—ç—Ç–æ–º—É —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ volume.

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
ls /opt/support-portal/ofd_fetch.sh

# –°–¥–µ–ª–∞–π—Ç–µ –µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x /opt/support-portal/ofd_fetch.sh
```

> ‚ö†Ô∏è **–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å —Ö–æ—Å—Ç–∞, –ù–ï —á–µ—Ä–µ–∑ `docker compose exec`** ‚Äî –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.

–í `docker-compose.yml` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å volume:
```yaml
- /opt/support-portal/ofd_fetch.sh:/usr/local/bin/ofd_fetch.sh:ro
```

---

## 6. –ó–∞–ø—É—Å–∫–∞–µ–º

```bash
cd /opt/support-portal
docker compose up -d --build
```

–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–Ω–∏–º–∞–µ—Ç 5‚Äì10 –º–∏–Ω—É—Ç. –°–ª–µ–¥–∏–º:

```bash
docker compose logs -f
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker compose ps
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã: `support-portal-db-1`, `support-portal-backend-1`, `support-portal-nginx-1`.

---

## 7. –ü—Ä–æ–≤–µ—Ä—è–µ–º Python-–ø–∞–∫–µ—Ç—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

```bash
docker compose exec backend python -c "
import cryptography, paramiko, openpyxl
print('cryptography OK')
print('paramiko OK')
print('openpyxl OK')
"
```

–ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –ø–∞–∫–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:

```bash
docker compose exec backend pip install cryptography paramiko openpyxl --break-system-packages
docker compose restart backend
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ø–∞–∫–µ—Ç—ã `cryptography`, `paramiko` –∏ `openpyxl` –º–æ–≥—É—Ç —Å–ª–µ—Ç–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`docker compose up --build`) –µ—Å–ª–∏ –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é –∫–æ–º–∞–Ω–¥–æ–π –≤—ã—à–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏.

---

## 8. –°–æ–∑–¥–∞—ë–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ —Ä–æ–ª–∏

```bash
docker compose exec backend python create_admin.py
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

| –†–æ–ª—å | –ö–ª–∏–µ–Ω—Ç—ã | –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã | –ö–æ–º–ø–∞–Ω–∏–∏ | –ó–∞–º–µ–Ω–∞ –§–ù | –ö–∞–ª–µ–Ω–¥–∞—Ä—å | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ |
|------|---------|-----------|---------|----------|----------|-------------|----------|
| –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| –°–≤—è–∑–∏—Å—Ç | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø | ‚úÖ | üëÅ –ø—Ä–æ—Å–º–æ—Ç—Ä | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |

---

## 9. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://–í–ê–®_IP` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
   - –£–∫–∞–∂–∏—Ç–µ SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –ø–∞—Ä–æ–ª—å –¥–ª—è –ú–∏–∫—Ä–æ—Ç–∏–∫–æ–≤
   - –£–∫–∞–∂–∏—Ç–µ SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–µ—Ä–≤–µ—Ä, –ø–æ—Ä—Ç, –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –∫–Ω–æ–ø–∫–æ–π ¬´–¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏¬ª
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ö–æ–º–ø–∞–Ω–∏–∏** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Å –ò–ù–ù –∏ —Ç–æ–∫–µ–Ω–æ–º –û–§–î (–∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ lk.ofd.ru)
5. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
6. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** ‚Üí –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
7. –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤

---

## 10. –†–∞–±–æ—Ç–∞ —Å –ö–ö–¢

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **¬´–ö–æ–º–ø–∞–Ω–∏–∏¬ª** –≤ –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é
2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–ø–∞–Ω–∏—é: –Ω–∞–∑–≤–∞–Ω–∏–µ, –ò–ù–ù, —Ç–æ–∫–µ–Ω –û–§–î (–±–µ—Ä—ë—Ç—Å—è –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ lk.ofd.ru ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí API)
3. –í –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ø–æ–ª–µ **¬´–ö–æ–º–ø–∞–Ω–∏—è¬ª** –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω **–ê–¥—Ä–µ—Å** ‚Äî –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ö–ö–¢

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ö–ö–¢

- **–í–∫–ª–∞–¥–∫–∞ –ö–ö–¢ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∫–∞—Ä—Ç–æ—á–∫–∏** ‚Üí –∫–Ω–æ–ø–∫–∞ **¬´–û–±–Ω–æ–≤–∏—Ç—å –ø–æ –†–ù–ú¬ª** ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ö–ö–¢
- **–í–∫–ª–∞–¥–∫–∞ –ö–ö–¢ –≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏** ‚Üí –∫–Ω–æ–ø–∫–∞ **¬´–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ö–ö–¢ –ø–æ –ò–ù–ù¬ª** ‚Äî –ø–æ–ª–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –ò–ù–ù + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∞–¥—Ä–µ—Å—É
- **–í–∫–ª–∞–¥–∫–∞ –ö–ö–¢ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞** ‚Üí –∫–Ω–æ–ø–∫–∏ **¬´–ò–ù–ù¬ª** –∏ **¬´–†–ù–ú¬ª** ‚Äî –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

### –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏

| –ö–Ω–æ–ø–∫–∞ | –ú–µ—Ç–æ–¥ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|--------|-------|-----------|
| –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ö–ö–¢ –ø–æ –ò–ù–ù | POST | –ü–æ–ª–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏ + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∞–¥—Ä–µ—Å—É. –ù–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—ã–µ –ö–ö–¢ |
| –û–±–Ω–æ–≤–∏—Ç—å –ø–æ –†–ù–ú | PATCH | –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ö–ö–¢ –ø–æ –∏—Ö –†–ù–ú. –ë—ã—Å—Ç—Ä–µ–µ |
| –ü–æ –†–ù–ú (–ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏) | PATCH | –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –≤–≤–µ–¥—ë–Ω–Ω—ã–º –≤—Ä—É—á–Ω—É—é –†–ù–ú. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –û–§–î

```
–ë—Ä–∞—É–∑–µ—Ä ‚Üí Django API (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) ‚Üí ofd_fetch.sh (—Ö–æ—Å—Ç) ‚Üí lk.ofd.ru
```

–°–∫—Ä–∏–ø—Ç `ofd_fetch.sh` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã:
```bash
# –ü–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É (–ø–æ–ª–Ω—ã–π)
python3 /opt/support-portal/ofd_fetch.sh <–ò–ù–ù> <–¢–û–ö–ï–ù> "–ì–æ—Ä–æ–¥, –£–ª–∏—Ü–∞, –¥. N"

# –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –ø–æ –†–ù–ú (–±—ã—Å—Ç—Ä—ã–π)
python3 /opt/support-portal/ofd_fetch.sh <–ò–ù–ù> <–¢–û–ö–ï–ù> 0001234567890123
```

---

## 11. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–±—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π)

```bash
/opt/support-portal/deploy-frontend.sh
```

---

## 12. –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
|-----------|---------|
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Python-–∫–æ–¥–µ –±—ç–∫–µ–Ω–¥–∞ | `docker compose restart backend` |
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (JSX, CSS) | `/opt/support-portal/deploy-frontend.sh` |
| –ù–æ–≤—ã–µ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt) | `docker compose up -d --build` |
| –ù–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `docker compose exec backend python manage.py migrate` |

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose logs -f backend
docker compose logs -f nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥
docker compose restart backend

# –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
/opt/support-portal/deploy-frontend.sh

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ requirements.txt –∏–ª–∏ Dockerfile)
docker compose up -d --build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose exec backend python manage.py migrate

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î
docker compose exec db pg_dump -U postgres support_portal > backup_$(date +%Y%m%d).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
cat backup_20240101.sql | docker compose exec -T db psql -U postgres support_portal

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö Python-–ø–∞–∫–µ—Ç–æ–≤
docker compose exec backend python -c "import cryptography, paramiko, openpyxl; print('–í—Å–µ –ø–∞–∫–µ—Ç—ã OK')"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç–∞ –û–§–î –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker compose exec backend ls -la /usr/local/bin/ofd_fetch.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–º–ø–∞–Ω–∏–π –∏ —Ç–æ–∫–µ–Ω–æ–≤ –û–§–î
docker compose exec backend python manage.py shell -c "
from apps.clients.models import OfdCompany
for c in OfdCompany.objects.all():
    print(c.id, c.name, c.inn, '—Ç–æ–∫–µ–Ω:', c.ofd_token[:10] + '...' if c.ofd_token else '–ù–ï–¢')
"

# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
docker compose exec backend python manage.py shell -c "
from apps.clients.models import Provider
providers = [('–†–æ—Å—Ç–µ–ª–µ–∫–æ–º','8-800-100-08-00'),('–ú–¢–°','8-800-250-08-90')]
for name, phone in providers:
    p, created = Provider.objects.get_or_create(name=name, defaults={'support_phones': phone})
    print('–°–æ–∑–¥–∞–Ω' if created else '–£–∂–µ –µ—Å—Ç—å', name)
"
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
cd /opt/support-portal
git pull

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
docker compose exec backend python manage.py migrate

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±—ç–∫–µ–Ω–¥
docker compose restart backend

# –î–µ–ø–ª–æ–∏–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –µ—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
/opt/support-portal/deploy-frontend.sh

# –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞–∫–µ—Ç—ã
docker compose exec backend python -c "import cryptography, paramiko, openpyxl; print('OK')"
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### üîç –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ü—Ä–∏ –ª—é–±–æ–π –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–π –æ—à–∏–±–∫–µ (500, 400, —Ç–æ–∫–µ–Ω—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç) ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∏—Ç `DEBUG=True`, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë—Ç –∑–∞–ø—Ä–æ—Å, –ø–æ–∫–∞–∂–µ—Ç traceback –∏ –≤–µ—Ä–Ω—ë—Ç `DEBUG=False`.

```bash
cd /opt/support-portal
bash diagnose.sh 2>&1 | tee /tmp/diag_result.txt
cat /tmp/diag_result.txt
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `diagnose.sh`:

```bash
#!/bin/bash
cd /opt/support-portal
DIVIDER="=================================================="

echo "$DIVIDER"
echo "1. –û–ö–†–£–ñ–ï–ù–ò–ï"
echo "$DIVIDER"
grep -E "DEBUG|ALLOWED_HOSTS|ENCRYPTION_KEY" .env | sed 's/=.*/=***/'
docker compose exec backend python manage.py shell -c "
from django.conf import settings
print('DEBUG:', settings.DEBUG)
print('ALLOWED_HOSTS:', settings.ALLOWED_HOSTS)
print('ENCRYPTION_KEY –∑–∞–¥–∞–Ω:', bool(getattr(settings, 'ENCRYPTION_KEY', '')))
print('ENCRYPTION_KEY –¥–ª–∏–Ω–∞:', len(getattr(settings, 'ENCRYPTION_KEY', '')))
"

echo ""; echo "$DIVIDER"; echo "2. –°–¢–ê–¢–£–° –ö–û–ù–¢–ï–ô–ù–ï–†–û–í"; echo "$DIVIDER"
docker compose ps

echo ""; echo "$DIVIDER"; echo "3. –ò–ú–ü–û–†–¢–´ –í VIEWS.PY"; echo "$DIVIDER"
grep -n "from .serializers\|OfdCompanyWriteSerializer\|OfdCompanySerializer" backend/apps/clients/views.py
echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ OfdCompanyViewSet:"
grep -c "class OfdCompanyViewSet" backend/apps/clients/views.py
grep -n "class OfdCompanyViewSet\|get_serializer_class\|OfdCompanyWriteSerializer" backend/apps/clients/views.py

echo ""; echo "$DIVIDER"; echo "4. –ü–ê–ö–ï–¢–´"; echo "$DIVIDER"
docker compose exec backend python -c "
import cryptography, paramiko, openpyxl
print('cryptography:', cryptography.__version__)
print('paramiko:', paramiko.__version__)
print('openpyxl:', openpyxl.__version__)
"

echo ""; echo "$DIVIDER"; echo "5. –¢–ï–°–¢ –®–ò–§–†–û–í–ê–ù–ò–Ø"; echo "$DIVIDER"
docker compose exec backend python manage.py shell -c "
from apps.clients.models import encrypt_value, decrypt_value
try:
    enc = encrypt_value('test_token_diag')
    dec = decrypt_value(enc)
    print('encrypt/decrypt:', 'OK' if dec == 'test_token_diag' else 'FAIL: ' + dec)
except Exception as e:
    import traceback; traceback.print_exc()
"

echo ""; echo "$DIVIDER"; echo "6. –í–ö–õ–Æ–ß–ê–ï–ú DEBUG=True"; echo "$DIVIDER"
cp .env .env.diag_backup
sed -i 's/DEBUG=False/DEBUG=True/' .env
docker compose restart backend > /dev/null 2>&1
sleep 7
echo "DEBUG –≤–∫–ª—é—á—ë–Ω"

echo ""; echo "$DIVIDER"; echo "7. PATCH –ó–ê–ü–†–û–° –° TRACEBACK"; echo "$DIVIDER"
docker compose exec backend python manage.py shell -c "
import traceback
from rest_framework.test import APIClient
from apps.clients.models import OfdCompany
from django.contrib.auth import get_user_model
User = get_user_model()
user = User.objects.filter(is_superuser=True).first()
company = OfdCompany.objects.first()
print(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user}')
print(f'–ö–æ–º–ø–∞–Ω–∏—è: {company.name} (id={company.id})')
client = APIClient()
client.force_authenticate(user=user)
try:
    r = client.patch(
        f'/api/clients/ofd-companies/{company.id}/',
        {'ofd_token': 'DIAG_TEST_TOKEN'},
        format='json',
        HTTP_HOST='192.168.142.145',
    )
    print('HTTP —Å—Ç–∞—Ç—É—Å:', r.status_code)
    if hasattr(r, 'data'): print('response.data:', r.data)
    print('content:', r.content[:1000].decode('utf-8', errors='replace'))
except Exception as e:
    traceback.print_exc()
company.refresh_from_db()
print('has_token –ø–æ—Å–ª–µ:', bool(company.ofd_token_encrypted))
print('token:', company.ofd_token)
"

echo ""; echo "$DIVIDER"; echo "8. –õ–û–ì–ò –ë–≠–ö–ï–ù–î–ê"; echo "$DIVIDER"
docker compose logs --tail=40 backend 2>&1 | grep -v "RuntimeWarning\|warnings.warn\|UnorderedObject\|Booting worker\|Listening at\|Starting gunicorn\|Control socket\|copied to\|No migrations\|Apply all\|accounts, admin"

echo ""; echo "$DIVIDER"; echo "9. CURL –¢–ï–°–¢"; echo "$DIVIDER"
TOKEN=$(docker compose exec backend python manage.py shell -c "
from rest_framework_simplejwt.tokens import RefreshToken
from django.contrib.auth import get_user_model
User = get_user_model()
user = User.objects.filter(is_superuser=True).first()
print(str(RefreshToken.for_user(user).access_token))
" 2>/dev/null | tail -1)
echo "–¢–æ–∫–µ–Ω: ${TOKEN:0:30}..."
curl -s -X PATCH "http://localhost/api/clients/ofd-companies/1/" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Host: 192.168.142.145" \
  -d '{"ofd_token": "CURL_TEST"}' | head -c 500

echo ""; echo ""; echo "$DIVIDER"; echo "10. –í–û–ó–í–†–ê–©–ê–ï–ú DEBUG=False"; echo "$DIVIDER"
cp .env.diag_backup .env
docker compose restart backend > /dev/null 2>&1
echo "DEBUG=False –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
echo "‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
```

---

**–ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
```bash
docker compose logs nginx --tail=30
# –ñ—ë—Å—Ç–∫–∏–π —Å–±—Ä–æ—Å –∫—ç—à–∞: Ctrl+Shift+R
```

**–û—à–∏–±–∫–∞ 500 –æ—Ç API**
```bash
docker compose logs backend --tail=50
```

**No module named 'cryptography' / 'paramiko' / 'openpyxl'**

–ü–∞–∫–µ—Ç—ã —Å–ª–µ—Ç–µ–ª–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:
```bash
docker compose exec backend pip install cryptography paramiko openpyxl --break-system-packages
docker compose restart backend
```

**–°–∫—Ä–∏–ø—Ç –û–§–î –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ**
```bash
ls -la /opt/support-portal/ofd_fetch.sh
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ docker-compose.yml –µ—Å—Ç—å volume –¥–ª—è ofd_fetch.sh
```

**–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç —Å–∫—Ä–∏–ø—Ç–∞ –û–§–î / timeout**
```bash
# –¢–µ—Å—Ç —Å —Ö–æ—Å—Ç–∞ (–Ω–µ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞!)
python3 /opt/support-portal/ofd_fetch.sh <–ò–ù–ù> <–¢–û–ö–ï–ù> "–ê–¥—Ä–µ—Å"
# –ï—Å–ª–∏ timeout ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –∏ –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Å —Ö–æ—Å—Ç–∞
```

**DEBUG –≤–∫–ª—é—á—ë–Ω —Å–ª—É—á–∞–π–Ω–æ**
```bash
# –ù–∞–π—Ç–∏ .env –∏ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ DEBUG=False
grep "DEBUG" /opt/support-portal/.env
docker compose restart backend
```

**–ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –±–∞–∑–µ**

–ß–µ—Ä–Ω–æ–≤–∏–∫–∏ —Å—Ç–∞—Ä—à–µ 2 —á–∞—Å–æ–≤ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–ª—è —Ä—É—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏:
```bash
docker compose exec backend python manage.py shell -c "
from apps.clients.models import Client
from django.utils import timezone
from datetime import timedelta
old = Client.objects.filter(is_draft=True, created_at__lt=timezone.now()-timedelta(hours=2))
print(f'–ù–∞–π–¥–µ–Ω–æ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤: {old.count()}')
for c in old:
    for f in c.files.all(): f.file.delete(); f.delete()
    c.delete()
print('–ì–æ—Ç–æ–≤–æ')
"
```

**–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã ENCRYPTION_KEY –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ —á–∏—Ç–∞—Ç—å—Å—è –ø–∞—Ä–æ–ª–∏**

–í–≤–µ–¥–∏—Ç–µ SSH –∏ SMTP –ø–∞—Ä–æ–ª–∏ –∑–∞–Ω–æ–≤–æ –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ù–∞—Å—Ç—Ä–æ–π–∫–∏¬ª, –∞ —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –û–§–î –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ö–æ–º–ø–∞–Ω–∏–∏¬ª.

**–ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–∏–≥—Ä–∞—Ü–∏–π (Conflicting migrations detected)**
```bash
cat > /opt/support-portal/backend/apps/accounts/migrations/0004_merge.py << 'MIGRATION'
from django.db import migrations
class Migration(migrations.Migration):
    dependencies = [
        ('accounts', '0002_user_birthday'),
        ('accounts', '0003_update_role_choices'),
    ]
    operations = []
MIGRATION
docker compose exec backend python manage.py migrate
```

**–û—à–∏–±–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ–ª—è–º –ö–æ–º–ø–∞–Ω–∏—è / –ò–ù–ù**

–ü–æ–ª—è `company` –∏ `inn` —è–≤–ª—è—é—Ç—Å—è –≤—ã—á–∏—Å–ª—è–µ–º—ã–º–∏ (`@property`) –∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ —Å–≤—è–∑–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `OfdCompany`. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ `ofd_company__name` –∏ `ofd_company__inn`. –ï—Å–ª–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî —Å–±—Ä–æ—Å—å—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (`Ctrl+Shift+R`).

**–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**
```bash
cd /opt/support-portal/frontend
rm -rf node_modules
npm install
npm run build
```

**–¢–æ–∫–µ–Ω –û–§–î –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è / –æ—à–∏–±–∫–∞ 500 –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏**

–ü—Ä–∏—á–∏–Ω–∞: –≤ `views.py` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–º–ø–æ—Ä—Ç `OfdCompanyWriteSerializer` –∏–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–π –∫–ª–∞—Å—Å `OfdCompanyViewSet`.

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º ‚Äî –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1
grep -c "class OfdCompanyViewSet" /opt/support-portal/backend/apps/clients/views.py

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–º–ø–æ—Ä—Ç–∞
grep "OfdCompanyWriteSerializer" /opt/support-portal/backend/apps/clients/views.py

# –ï—Å–ª–∏ –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
sed -i 's/OfdCompanySerializer,$/OfdCompanySerializer, OfdCompanyWriteSerializer,/' \
  /opt/support-portal/backend/apps/clients/views.py

docker compose restart backend
```

**–û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ö–ö–¢ / –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–µ—Ç**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –û–§–î:

`check_ofd_network.sh` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –∫ `lk.ofd.ru` —Å —Ö–æ—Å—Ç–∞. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –≤–æ–æ–±—â–µ –Ω–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ (TimeoutError –Ω–∞ –≤—Å–µ –∫–æ–º–ø–∞–Ω–∏–∏):
```bash
bash /opt/support-portal/check_ofd_network.sh
```
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: TCP 443 OK, curl –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP 403 –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –∑–Ω–∞—á–∏—Ç —Å–µ—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç.

`check_ofd_tokens.sh` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –≤ –±–∞–∑–µ —Ä–µ–∞–ª—å–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –∫ API. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –∫–æ–º–ø–∞–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –∏ –ø–æ—á–µ–º—É:
```bash
bash /opt/support-portal/check_ofd_tokens.sh
```
–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–ø–∞–Ω–∏–∏: `‚úÖ OK` (—Ç–æ–∫–µ–Ω —Ä–∞–±–æ—á–∏–π), `‚ùå HTTP 403` (—Ç–æ–∫–µ–Ω –ø—Ä–æ—Ç—É—Ö ‚Äî –æ–±–Ω–æ–≤–∏—Ç–µ –≤ `lk.ofd.ru`), `‚ùå TimeoutError` (—Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω), `‚ùå –ö–ò–†–ò–õ–õ–ò–¶–ê –í –¢–û–ö–ï–ù–ï` (–≤–≤–µ–¥—ë–Ω –º—É—Å–æ—Ä –≤–º–µ—Å—Ç–æ —Ç–æ–∫–µ–Ω–∞).

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ö–ö–¢ –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)**

API `lk.ofd.ru` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤: –Ω–µ –±–æ–ª–µ–µ 1 –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥—É. –ü—Ä–∏ 700 –∫–∞—Å—Å–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç ~13 –º–∏–Ω—É—Ç. –≠—Ç–æ —à—Ç–∞—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ. Gunicorn –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å `--timeout 1000` —á—Ç–æ–±—ã –≤–æ—Ä–∫–µ—Ä –Ω–µ —É–±–∏–≤–∞–ª—Å—è —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏.

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–§–∞–π–ª `.env` **–Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ git**. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `.gitignore` —Å–æ–¥–µ—Ä–∂–∏—Ç:

```
.env
media/
*.pyc
__pycache__/
```

–ü—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π:
```bash
openssl rand -hex 50                                                                         # –Ω–æ–≤—ã–π SECRET_KEY
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"  # –Ω–æ–≤—ã–π ENCRYPTION_KEY
docker compose restart backend
# –ü–æ—Å–ª–µ ‚Äî –∑–∞–Ω–æ–≤–æ –≤–≤–µ–¥–∏—Ç–µ SSH/SMTP –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã –û–§–î
```

–†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–∞–ø–∫–∏ `media/`.

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS

```bash
apt install certbot python3-certbot-nginx -y
docker compose stop nginx
certbot certonly --standalone -d –≤–∞—à-–¥–æ–º–µ–Ω.ru
# –û–±–Ω–æ–≤–∏—Ç–µ nginx/default.conf ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –±–ª–æ–∫ SSL
docker compose start nginx
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
support-portal/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ accounts/             # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ä–æ–ª–∏, JWT
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py         # User (+ –ø–æ–ª–µ birthday), Role
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ serializers.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ clients/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ models.py         # Client, Provider, ClientFile, SystemSettings,
‚îÇ   ‚îÇ       ‚îÇ                     # DutySchedule, CustomHoliday, OfdCompany, KktData
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ views.py          # API, SSH, Excel, –ø—Ä–æ–≤–∞–π–¥–µ—Ä, –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –ö–ö–¢, –∑–∞–º–µ–Ω–∞ –§–ù
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ serializers.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ settings_views.py # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SSH –∏ SMTP
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ migrations/       # –≤–∫–ª—é—á–∞—è 0024_kktdata, 0025_ofdcompany
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ create_admin.py
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientsPage.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientDetailPage.jsx  # –í–∫–ª–∞–¥–∫–∞ –ö–ö–¢: –ø—Ä–æ—Å–º–æ—Ç—Ä + –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å –ø–æ –†–ù–ú¬ª
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientFormPage.jsx    # –í–∫–ª–∞–¥–∫–∞ –ö–ö–¢: –ø–æ–ª—è –†–ù–ú, –∫–Ω–æ–ø–∫–∏ –ò–ù–ù/–†–ù–ú/–¥–æ–±–∞–≤–∏—Ç—å –ø–æ –†–ù–ú
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OfdCompaniesPage.jsx  # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏—è–º–∏ (–ò–ù–ù, —Ç–æ–∫–µ–Ω –û–§–î)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FnReplacementPage.jsx # –†–∞–∑–¥–µ–ª ¬´–ó–∞–º–µ–Ω–∞ –§–ù¬ª: –≤–∫–ª–∞–¥–∫–∏ –û–±—â–∏–π –∏ –ü–æ –º–µ—Å—è—Ü–∞–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CalendarPage.jsx      # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–µ–∂—É—Ä—Å—Ç–≤ —Å –º—É–ª—å—Ç–∏–≤—ã–¥–µ–ª–µ–Ω–∏–µ–º (Ctrl+–∫–ª–∏–∫)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsPage.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UsersPage.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProvidersPage.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppLayout.jsx         # –ú–µ–Ω—é + –ø—É–Ω–∫—Ç—ã ¬´–ö–æ–º–ø–∞–Ω–∏–∏¬ª, ¬´–ó–∞–º–µ–Ω–∞ –§–ù¬ª
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authStore.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ themeStore.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/index.js
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ default.conf
‚îú‚îÄ‚îÄ media/                         # –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã (bind mount, –Ω–µ –≤ git)
‚îú‚îÄ‚îÄ ofd_fetch.sh                   # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –û–§–î (–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ)
‚îú‚îÄ‚îÄ check_ofd_network.sh           # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏ –¥–æ lk.ofd.ru
‚îú‚îÄ‚îÄ check_ofd_tokens.sh            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤ –≤—Å–µ—Ö –∫–æ–º–ø–∞–Ω–∏–π
‚îú‚îÄ‚îÄ deploy-frontend.sh
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env                           # –ù–µ –≤ git!
‚îî‚îÄ‚îÄ .env.example
```

---

## Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)

| –ü–∞–∫–µ—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|-----------|
| django | –û—Å–Ω–æ–≤–Ω–æ–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ |
| djangorestframework | REST API |
| djangorestframework-simplejwt | JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| psycopg2-binary | –î—Ä–∞–π–≤–µ—Ä PostgreSQL |
| django-cors-headers | CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ |
| django-filter | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ API |
| python-dotenv | –ó–∞–≥—Ä—É–∑–∫–∞ .env —Ñ–∞–π–ª–∞ |
| cryptography | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π SSH, SMTP –∏ —Ç–æ–∫–µ–Ω–æ–≤ –û–§–î (Fernet) |
| paramiko | SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ú–∏–∫—Ä–æ—Ç–∏–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ IP |
| openpyxl | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| gunicorn | WSGI-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ |
| Pillow | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |
