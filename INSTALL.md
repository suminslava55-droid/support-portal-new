# Support Portal ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**Support Portal** ‚Äî –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (–∞–ø—Ç–µ–∫–∞–º–∏), –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ –∏ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|------------|
| Backend | Django 4.x + Django REST Framework | REST API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Frontend | React 18 + Ant Design | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | PostgreSQL 16 | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| –í–µ–±-—Å–µ—Ä–≤–µ—Ä | Nginx (Alpine) | –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ –∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker + Docker Compose | –ò–∑–æ–ª—è—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ |
| –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ | Node.js 18 + npm | –ö–æ–º–ø–∏–ª—è—Ü–∏—è React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏

**–ö–ª–∏–µ–Ω—Ç—ã**
- –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞: –∞–¥—Ä–µ—Å, –∫–æ–º–ø–∞–Ω–∏—è, –ò–ù–ù, —Ç–µ–ª–µ—Ñ–æ–Ω, email, –∫–æ–¥ –∞–ø—Ç–µ–∫–∏, ICCID
- –ë–ª–æ–∫ **–°–µ—Ç—å**: –ø–æ–¥—Å–µ—Ç—å –∞–ø—Ç–µ–∫–∏, –≤–Ω–µ—à–Ω–∏–π IP (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞), –ú–∏–∫—Ä–æ—Ç–∏–∫ IP (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞, –∞–≤—Ç–æ: .1), –°–µ—Ä–≤–µ—Ä IP (–∞–≤—Ç–æ: .2), –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (‚ö° –û–ø—Ç–æ–≤–æ–ª–æ–∫–Ω–æ, ‚òéÔ∏è DSL, üîå –ö–∞–±–µ–ª—å, üì° –ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–µ, üì∂ –ú–æ–¥–µ–º, ‚ÜîÔ∏è MR-Net), —Ç–∞—Ä–∏—Ñ, –ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç, ‚Ññ –¥–æ–≥–æ–≤–æ—Ä–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ç–∏–ø–∞ –ú–æ–¥–µ–º –∏–ª–∏ MR-Net: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ù–æ–º–µ—Ä (–º–æ–¥–µ–º/SIM) –∏ ICCID –º–æ–¥–µ–º–∞
- –ü–µ—Ä–µ–¥–∞—á–∞ –º–æ–¥–µ–º–∞ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ IP —Å –ú–∏–∫—Ä–æ—Ç–∏–∫–∞ –ø–æ SSH
- –ó–∞–º–µ—Ç–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –∑–∞–ø–∏—Å–∏ –≤–∏–¥–Ω—ã —Å—Ä–∞–∑—É, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è)
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–¥–æ 5 –ú–ë –Ω–∞ —Ñ–∞–π–ª): –ø—Ä–µ–≤—å—é –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –≥–∞–ª–µ—Ä–µ–µ–π, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
- –°–∏—Å—Ç–µ–º–∞ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ Excel —Å —É—á—ë—Ç–æ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏**
- RBAC: —Ä–æ–ª–∏ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –ü—Ä–∞–≤–∞: –ø—Ä–æ—Å–º–æ—Ç—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ä–æ–ª—è–º–∏, –ø–æ–ª—è–º–∏

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã**
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
- SSH-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ú–∏–∫—Ä–æ—Ç–∏–∫–∞–º (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ Fernet)
- –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ SSH-–¥–∞–Ω–Ω—ã—Ö

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

- Ubuntu 20.04 / 22.04 / 24.04
- 2 –ì–ë RAM –º–∏–Ω–∏–º—É–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4 –ì–ë)
- 20 –ì–ë –¥–∏—Å–∫–∞
- –û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 80 (–∏ 443 –ø—Ä–∏ HTTPS)

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 1.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
apt update && apt upgrade -y
```

### 1.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (backend, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, nginx) –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

```bash
curl -fsSL https://get.docker.com | sh
```

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose Plugin

Docker Compose –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `docker-compose.yml`.

```bash
apt install docker-compose-plugin -y
```

### 1.4 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git

Git –Ω—É–∂–µ–Ω –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞.

```bash
apt install git -y
```

### 1.5 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python 3 –∏ pip

Python –Ω—É–∂–µ–Ω –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

```bash
apt install python3 python3-pip -y
```

### 1.6 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ cryptography

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `ENCRYPTION_KEY` ‚Äî Fernet-–∫–ª—é—á–∞, –∫–æ—Ç–æ—Ä—ã–º —à–∏—Ñ—Ä—É–µ—Ç—Å—è SSH-–ø–∞—Ä–æ–ª—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```bash
pip3 install cryptography --break-system-packages
```

### 1.7 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js –∏ npm

Node.js –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) –ø—Ä—è–º–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∑–∞ 20‚Äì40 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ Docker-–æ–±—Ä–∞–∑–∞ (5‚Äì10 –º–∏–Ω—É—Ç).

> **–í–∞–∂–Ω–æ:** Node.js –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –≤ –º–æ–º–µ–Ω—Ç —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. –í —Ä–∞–±–æ—Ç–µ —Å–∞–π—Ç–∞ –æ–Ω –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –∏ –Ω–∏–∫–∞–∫ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.

```bash
apt install nodejs npm -y
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏–∏:

```bash
node --version   # v18.x.x –∏–ª–∏ –≤—ã—à–µ
npm --version    # 9.x.x –∏–ª–∏ –≤—ã—à–µ
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑):

```bash
cd /opt/support-portal/frontend
npm install
```

### 1.8 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

```bash
# curl ‚Äî HTTP-–∑–∞–ø—Ä–æ—Å—ã, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤
apt install curl -y

# nano ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è .env –∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤
apt install nano -y

# iputils-ping ‚Äî —É—Ç–∏–ª–∏—Ç–∞ ping, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ IP
apt install iputils-ping -y

# openssl ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SECRET_KEY –¥–ª—è Django
apt install openssl -y
```

### 1.9 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
docker --version          # Docker version 24.x.x –∏–ª–∏ –≤—ã—à–µ
docker compose version    # Docker Compose version v2.x.x –∏–ª–∏ –≤—ã—à–µ
git --version             # git version 2.x.x
python3 --version         # Python 3.x.x
node --version            # v18.x.x
npm --version             # 9.x.x
curl --version            # curl 7.x.x
ping -c1 8.8.8.8          # –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ –ø–∏–Ω–≥
```

---

## 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–µ–∫—Ç

```bash
git clone https://github.com/suminslava55-droid/support-portal-new.git /opt/support-portal
cd /opt/support-portal
```

---

## 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
nano .env
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `.env`:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_NAME=support_portal
DB_USER=postgres
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_HOST=db
DB_PORT=5432

# Django
SECRET_KEY=CHANGE_ME_VERY_LONG_SECRET_KEY_HERE
DEBUG=False
ALLOWED_HOSTS=your-ip-or-domain,localhost
CORS_ALLOWED_ORIGINS=http://your-ip-or-domain,http://localhost

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ SSH-–ø–∞—Ä–æ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
ENCRYPTION_KEY=CHANGE_ME_FERNET_KEY
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π

**SECRET_KEY:**
```bash
openssl rand -hex 50
```

**ENCRYPTION_KEY:**
```bash
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

**ALLOWED_HOSTS –∏ CORS_ALLOWED_ORIGINS:**
```env
# –¢–æ–ª—å–∫–æ IP
ALLOWED_HOSTS=94.130.1.1,localhost
CORS_ALLOWED_ORIGINS=http://94.130.1.1,http://localhost

# –° –¥–æ–º–µ–Ω–æ–º
ALLOWED_HOSTS=support.mycompany.ru,localhost
CORS_ALLOWED_ORIGINS=https://support.mycompany.ru,http://localhost
```

### –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ .env

```env
DB_NAME=support_portal
DB_USER=postgres
DB_PASSWORD=qX7!mN3kP9@support
DB_HOST=db
DB_PORT=5432

SECRET_KEY=a3f8c2d1e4b7a9f0c3d6e2b5a8f1c4d7e0b3a6f9c2d5e8b1a4f7c0d3e6b9a2f5c8d1e4b7
DEBUG=False
ALLOWED_HOSTS=94.130.1.1,localhost
CORS_ALLOWED_ORIGINS=http://94.130.1.1,http://localhost

ENCRYPTION_KEY=ySKoI9K2_Uj2qjNUSxREYTFIW3o-HILiIMYZ5enMgYs=
```

> **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ nano:** `Ctrl+O` ‚Üí `Enter` ‚Üí `Ctrl+X`

---

## 4. –•—Ä–∞–Ω–∏–ª–∏—â–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤

–í–ª–æ–∂–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `./media` –Ω–∞ —Ö–æ—Å—Ç–µ (bind mount). –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.

```bash
mkdir -p /opt/support-portal/media
```

---

## 5. –ó–∞–ø—É—Å–∫–∞–µ–º

```bash
cd /opt/support-portal
docker compose up -d --build
```

–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–Ω–∏–º–∞–µ—Ç 5‚Äì10 –º–∏–Ω—É—Ç. –°–ª–µ–¥–∏–º –∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º:

```bash
docker compose logs -f
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏—Å—å:

```bash
docker compose ps
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã: `support-portal-db-1`, `support-portal-backend-1`, `support-portal-nginx-1`.

---

## 6. –°–æ–∑–¥–∞—ë–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ —Ä–æ–ª–∏

```bash
docker compose exec backend python create_admin.py
```

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ä–æ–ª—å **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**, —Ä–æ–ª—å **–¢–µ—Ö–Ω–∏–∫** –∏ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

---

## 7. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://–í–ê–®_IP` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí —É–∫–∞–∂–∏—Ç–µ SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ SSH –ø–∞—Ä–æ–ª—å –¥–ª—è –ú–∏–∫—Ä–æ—Ç–∏–∫–æ–≤
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
5. –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤

---

## 8. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–±—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π)

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ Docker:

```bash
/opt/support-portal/deploy-frontend.sh
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫—Ä–∏–ø—Ç–∞:

```bash
#!/bin/bash
set -e
echo "–°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞..."
cd /opt/support-portal/frontend

if [ ! -d "node_modules" ]; then
  echo "–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..."
  npm install
fi

npm run build

echo "–ö–æ–ø–∏—Ä—É–µ–º –≤ nginx..."
docker cp build/. support-portal-nginx-1:/usr/share/nginx/html/
docker exec support-portal-nginx-1 nginx -s reload

echo "–ì–æ—Ç–æ–≤–æ!"
```

**–ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
|-----------|---------|
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Python-–∫–æ–¥–µ –±—ç–∫–µ–Ω–¥–∞ | `docker compose restart backend` |
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (JSX, CSS) | `/opt/support-portal/deploy-frontend.sh` |
| –ù–æ–≤—ã–µ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt) | `docker compose up -d --build` |
| –ù–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `docker compose exec backend python manage.py migrate` |

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose logs -f backend
docker compose logs -f nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥
docker compose restart backend

# –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
/opt/support-portal/deploy-frontend.sh

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker compose up -d --build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose exec backend python manage.py migrate

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î
docker compose exec db pg_dump -U postgres support_portal > backup_$(date +%Y%m%d).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
cat backup_20240101.sql | docker compose exec -T db psql -U postgres support_portal
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
cd /opt/support-portal
git pull

# –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –±—ç–∫–µ–Ω–¥
docker compose restart backend
docker compose exec backend python manage.py migrate

# –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
/opt/support-portal/deploy-frontend.sh

# –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
docker compose up -d --build
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

**–ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
```bash
# –ñ—ë—Å—Ç–∫–∏–π —Å–±—Ä–æ—Å –∫—ç—à–∞: Ctrl+Shift+R
# –°–º–æ—Ç—Ä–∏–º –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞: F12 ‚Üí Console
docker compose logs nginx --tail=30
```

**–û—à–∏–±–∫–∞ 500 –æ—Ç API**
```bash
docker compose logs backend --tail=50
```

**–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**
```bash
cd /opt/support-portal/frontend
rm -rf node_modules
npm install
npm run build
```

**TLS timeout –ø—Ä–∏ —Å–±–æ—Ä–∫–µ Docker**
```bash
docker compose up -d
```

**–ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –±–∞–∑–µ**
```bash
docker compose exec backend python manage.py shell -c "
from apps.clients.models import Client
from django.utils import timezone
from datetime import timedelta
old = Client.objects.filter(is_draft=True, created_at__lt=timezone.now()-timedelta(days=1))
print(f'–ù–∞–π–¥–µ–Ω–æ: {old.count()}')
for c in old:
    for f in c.files.all(): f.file.delete(); f.delete()
    c.delete()
print('–ì–æ—Ç–æ–≤–æ')
"
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–§–∞–π–ª `.env` **–Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ git**. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `.gitignore` —Å–æ–¥–µ—Ä–∂–∏—Ç:

```
.env
media/
*.pyc
__pycache__/
```

–ü—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ `.env`:
```bash
openssl rand -hex 50
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
docker compose restart backend
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS

```bash
apt install certbot python3-certbot-nginx -y
docker compose stop nginx
certbot certonly --standalone -d –≤–∞—à-–¥–æ–º–µ–Ω.ru
# –û–±–Ω–æ–≤–∏—Ç–µ nginx/default.conf ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –±–ª–æ–∫ SSL
docker compose start nginx
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
support-portal/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ accounts/             # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ä–æ–ª–∏, JWT
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ clients/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ models.py         # Client, Provider, ClientFile, SystemSettings
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ views.py          # API, SSH, —ç–∫—Å–ø–æ—Ä—Ç Excel, –ø–µ—Ä–µ–¥–∞—á–∞ –º–æ–¥–µ–º–∞
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ serializers.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ settings_views.py # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SSH
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ config/settings.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientsPage.jsx       # –°–ø–∏—Å–æ–∫ + —ç–∫—Å–ø–æ—Ä—Ç Excel
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientDetailPage.jsx  # –ö–∞—Ä—Ç–æ—á–∫–∞: –±–ª–æ–∫–∏ –û—Å–Ω–æ–≤–Ω–æ–µ/–°–µ—Ç—å/–ü—Ä–æ–≤–∞–π–¥–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientFormPage.jsx    # –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø–µ—Ä–µ–¥–∞—á–∞ –º–æ–¥–µ–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsPage.jsx      # SSH –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UsersPage.jsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProvidersPage.jsx
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ npm (–Ω–µ –≤ git)
‚îÇ   ‚îú‚îÄ‚îÄ build/                    # –°–æ–±—Ä–∞–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–Ω–µ –≤ git)
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ nginx/default.conf
‚îú‚îÄ‚îÄ media/                        # –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ deploy-frontend.sh            # –°–∫—Ä–∏–ø—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –¥–µ–ø–ª–æ—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env                          # –ù–µ –≤ git!
‚îî‚îÄ‚îÄ .env.example
```

---

## Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)

| –ü–∞–∫–µ—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|-----------|
| django | –û—Å–Ω–æ–≤–Ω–æ–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ |
| djangorestframework | REST API |
| djangorestframework-simplejwt | JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| psycopg2-binary | –î—Ä–∞–π–≤–µ—Ä PostgreSQL |
| django-cors-headers | CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ |
| django-filter | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ API |
| python-dotenv | –ó–∞–≥—Ä—É–∑–∫–∞ .env —Ñ–∞–π–ª–∞ |
| cryptography | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ SSH-–ø–∞—Ä–æ–ª—è (Fernet) |
| paramiko | SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ú–∏–∫—Ä–æ—Ç–∏–∫—É |
| openpyxl | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ |
| gunicorn | WSGI-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ |
| Pillow | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |