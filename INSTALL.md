# Support Portal ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**Support Portal** ‚Äî –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (–∞–ø—Ç–µ–∫–∞–º–∏), –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ –∏ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|------------|
| Backend | Django 4.x + Django REST Framework | REST API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Frontend | React 18 + Ant Design | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | PostgreSQL 16 | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| –í–µ–±-—Å–µ—Ä–≤–µ—Ä | Nginx (Alpine) | –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ –∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker + Docker Compose | –ò–∑–æ–ª—è—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ |
| –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ | Node.js 18 + npm | –ö–æ–º–ø–∏–ª—è—Ü–∏—è React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏

**–ö–ª–∏–µ–Ω—Ç—ã**
- –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞: –∞–¥—Ä–µ—Å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ), –∫–æ–º–ø–∞–Ω–∏—è, –ò–ù–ù, —Ç–µ–ª–µ—Ñ–æ–Ω, email, –∫–æ–¥ –∞–ø—Ç–µ–∫–∏, ICCID
- –ë–ª–æ–∫ **–°–µ—Ç—å**: –ø–æ–¥—Å–µ—Ç—å –∞–ø—Ç–µ–∫–∏, –≤–Ω–µ—à–Ω–∏–π IP, –ú–∏–∫—Ä–æ—Ç–∏–∫ IP (–∞–≤—Ç–æ: .1), –°–µ—Ä–≤–µ—Ä IP (–∞–≤—Ç–æ: .2), –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- **–ü—Ä–æ–≤–∞–π–¥–µ—Ä 1 –∏ –ü—Ä–æ–≤–∞–π–¥–µ—Ä 2**: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, —Ç–∞—Ä–∏—Ñ, –ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç, ‚Ññ –¥–æ–≥–æ–≤–æ—Ä–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- –ü—Ä–∏ —Ç–∏–ø–µ –ú–æ–¥–µ–º –∏–ª–∏ MR-Net: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ù–æ–º–µ—Ä (–º–æ–¥–µ–º/SIM) –∏ ICCID –º–æ–¥–µ–º–∞
- –ü–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —Å –≤—ã–±–æ—Ä–æ–º —Å–ª–æ—Ç–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ IP —Å –ú–∏–∫—Ä–æ—Ç–∏–∫–∞ –ø–æ SSH (paramiko)
- –ó–∞–º–µ—Ç–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–¥–æ 5 –ú–ë): —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
- –°–∏—Å—Ç–µ–º–∞ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ Excel —Å –≤—ã–±–æ—Ä–æ–º –ø–æ–ª–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ Email
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
- –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage)

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏**
- RBAC: —Ä–æ–ª–∏ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –†–æ–ª–∏: **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**, **–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**, **–°–≤—è–∑–∏—Å—Ç**
- –ü—Ä–∞–≤–∞: –ø—Ä–æ—Å–º–æ—Ç—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ä–æ–ª—è–º–∏, –ø–æ–ª—è–º–∏
- –ü–æ–ª–µ **–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –¥–µ–∂—É—Ä—Å—Ç–≤
- –†–æ–ª—å **–°–≤—è–∑–∏—Å—Ç**: –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑–¥–µ–ª–∞–º –ö–ª–∏–µ–Ω—Ç—ã –∏ –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã, –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –Ω—ë–º

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã**
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–ª–∏–µ–Ω—Ç–∞

**–ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–µ–∂—É—Ä—Å—Ç–≤**
- –¢–∞–±–ª–∏—Ü–∞: —Å—Ç—Ä–æ–∫–∏ ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, —Å—Ç–æ–ª–±—Ü—ã ‚Äî –¥–Ω–∏ –º–µ—Å—è—Ü–∞
- –¢–∏–ø—ã –¥–µ–∂—É—Ä—Å—Ç–≤ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –º–∞—Ä–∫–∏—Ä–æ–≤–∫–æ–π: –¢–µ–ª–µ—Ñ–æ–Ω (–∑–µ–ª—ë–Ω—ã–π), –†–∞–±–æ—Ç–∞ –¥–Ω—ë–º (—Å–∏–Ω–∏–π), –¢–µ–ª–µ—Ñ–æ–Ω + –¥–µ–Ω—å (–∑–µ–ª—ë–Ω—ã–π), –û—Ç–ø—É—Å–∫ (–∂—ë–ª—Ç—ã–π), –ó–∞–Ω—è—Ç (–∫—Ä–∞—Å–Ω—ã–π)
- –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –≤—ã–¥–µ–ª—è—é—Ç—Å—è –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º (#FF9900)
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø–æ–º–µ—Ç–∏—Ç—å –ª—é–±–æ–π –¥–µ–Ω—å –∫–∞–∫ –≤—ã—Ö–æ–¥–Ω–æ–π –∏–ª–∏ —Ä–∞–±–æ—á–∏–π (–ø—Ä–∞–∑–¥–Ω–∏–∫–∏, –ø–µ—Ä–µ–Ω–æ—Å—ã)
- –î–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: —è—á–µ–π–∫–∞ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è —Ä–æ–∑–æ–≤–æ–π —Ä–∞–º–∫–æ–π, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è üéÇ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π üéâ
- –ö–Ω–æ–ø–∫–∞ **–û—Ç—á—ë—Ç –∑–∞ –º–µ—Å—è—Ü** ‚Äî —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–Ω–µ–π –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
- –ö–Ω–æ–ø–∫–∞ **–û—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É** (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) ‚Äî —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–µ–∂—É—Ä—Å—Ç–≤–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
- –£–¥–æ–±–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–µ–≤: –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ –º–µ—Å—è—Ü–∞ –∏ –≥–æ–¥–∞
- –†–æ–ª—å –°–≤—è–∑–∏—Å—Ç –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
- SSH-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ú–∏–∫—Ä–æ—Ç–∏–∫–∞–º (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å —à–∏—Ñ—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Fernet/cryptography)
- SMTP-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ Email (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å —à–∏—Ñ—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Fernet/cryptography)
- –ö–Ω–æ–ø–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞
- –ö–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

- Ubuntu 20.04 / 22.04 / 24.04
- 2 –ì–ë RAM –º–∏–Ω–∏–º—É–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4 –ì–ë)
- 20 –ì–ë –¥–∏—Å–∫–∞
- –û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 80 (–∏ 443 –ø—Ä–∏ HTTPS)

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 1.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
apt update && apt upgrade -y
```

### 1.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

```bash
curl -fsSL https://get.docker.com | sh
```

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose Plugin

```bash
apt install docker-compose-plugin -y
```

### 1.4 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git

```bash
apt install git -y
```

### 1.5 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python 3 –∏ pip

Python –Ω—É–∂–µ–Ω –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.

```bash
apt install python3 python3-pip -y
```

### 1.6 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ cryptography

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `ENCRYPTION_KEY` ‚Äî Fernet-–∫–ª—é—á–∞, –∫–æ—Ç–æ—Ä—ã–º —à–∏—Ñ—Ä—É—é—Ç—Å—è SSH –∏ SMTP –ø–∞—Ä–æ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```bash
pip3 install cryptography --break-system-packages
```

### 1.7 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js –∏ npm

Node.js –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (20‚Äì40 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 5‚Äì10 –º–∏–Ω –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ Docker).

```bash
apt install nodejs npm -y
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏–∏:

```bash
node --version   # v18.x.x –∏–ª–∏ –≤—ã—à–µ
npm --version    # 9.x.x –∏–ª–∏ –≤—ã—à–µ
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑):

```bash
cd /opt/support-portal/frontend
npm install
```

### 1.8 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

```bash
apt install curl nano iputils-ping openssl -y
```

### 1.9 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
docker --version
docker compose version
git --version
python3 --version
node --version
npm --version
ping -c1 8.8.8.8
```

---

## 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–µ–∫—Ç

```bash
git clone https://github.com/suminslava55-droid/support-portal-new.git /opt/support-portal
cd /opt/support-portal
```

---

## 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
nano .env
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `.env`:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_NAME=support_portal
DB_USER=postgres
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_HOST=db
DB_PORT=5432

# Django
SECRET_KEY=CHANGE_ME_VERY_LONG_SECRET_KEY_HERE
DEBUG=False
ALLOWED_HOSTS=your-ip-or-domain,localhost
CORS_ALLOWED_ORIGINS=http://your-ip-or-domain,http://localhost

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (SSH –∏ SMTP) –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
ENCRYPTION_KEY=CHANGE_ME_FERNET_KEY
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π

**SECRET_KEY:**
```bash
openssl rand -hex 50
```

**ENCRYPTION_KEY** (Fernet-–∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è SSH –∏ SMTP –ø–∞—Ä–æ–ª–µ–π):
```bash
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

### –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ .env

```env
DB_NAME=support_portal
DB_USER=postgres
DB_PASSWORD=qX7!mN3kP9@support
DB_HOST=db
DB_PORT=5432

SECRET_KEY=a3f8c2d1e4b7a9f0c3d6e2b5a8f1c4d7e0b3a6f9c2d5e8b1a4f7c0d3e6b9a2f5c8d1e4b7
DEBUG=False
ALLOWED_HOSTS=94.130.1.1,localhost
CORS_ALLOWED_ORIGINS=http://94.130.1.1,http://localhost

ENCRYPTION_KEY=ySKoI9K2_Uj2qjNUSxREYTFIW3o-HILiIMYZ5enMgYs=
```

> **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ nano:** `Ctrl+O` ‚Üí `Enter` ‚Üí `Ctrl+X`

---

## 4. –•—Ä–∞–Ω–∏–ª–∏—â–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤

```bash
mkdir -p /opt/support-portal/media
```

---

## 5. –ó–∞–ø—É—Å–∫–∞–µ–º

```bash
cd /opt/support-portal
docker compose up -d --build
```

–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–Ω–∏–º–∞–µ—Ç 5‚Äì10 –º–∏–Ω—É—Ç. –°–ª–µ–¥–∏–º:

```bash
docker compose logs -f
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker compose ps
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã: `support-portal-db-1`, `support-portal-backend-1`, `support-portal-nginx-1`.

---

## 6. –°–æ–∑–¥–∞—ë–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ —Ä–æ–ª–∏

–†–æ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

```bash
docker compose exec backend python create_admin.py
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** ‚Äî –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
- **–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –∫–ª–∏–µ–Ω—Ç–∞–º –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º, –±–µ–∑ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- **–°–≤—è–∑–∏—Å—Ç** ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤, –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é

---

## 7. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://–í–ê–®_IP` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
   - –£–∫–∞–∂–∏—Ç–µ SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –ø–∞—Ä–æ–ª—å –¥–ª—è –ú–∏–∫—Ä–æ—Ç–∏–∫–æ–≤
   - –£–∫–∞–∂–∏—Ç–µ SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ Email (—Å–µ—Ä–≤–µ—Ä, –ø–æ—Ä—Ç, –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –∫–Ω–æ–ø–∫–æ–π ¬´–¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏¬ª
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
5. –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤

---

## 8. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–±—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π)

```bash
/opt/support-portal/deploy-frontend.sh
```

---

## 9. –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
|-----------|---------|
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Python-–∫–æ–¥–µ –±—ç–∫–µ–Ω–¥–∞ | `docker compose restart backend` |
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (JSX, CSS) | `/opt/support-portal/deploy-frontend.sh` |
| –ù–æ–≤—ã–µ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt) | `docker compose up -d --build` |
| –ù–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `docker compose exec backend python manage.py migrate` |

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose logs -f backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥
docker compose restart backend

# –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
/opt/support-portal/deploy-frontend.sh

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ requirements.txt –∏–ª–∏ Dockerfile)
docker compose up -d --build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose exec backend python manage.py migrate

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î
docker compose exec db pg_dump -U postgres support_portal > backup_$(date +%Y%m%d).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
cat backup_20240101.sql | docker compose exec -T db psql -U postgres support_portal
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
cd /opt/support-portal
git pull

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
docker compose exec backend python manage.py migrate

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±—ç–∫–µ–Ω–¥
docker compose restart backend

# –î–µ–ø–ª–æ–∏–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
/opt/support-portal/deploy-frontend.sh
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

**–ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
```bash
docker compose logs nginx --tail=30
# –ñ—ë—Å—Ç–∫–∏–π —Å–±—Ä–æ—Å –∫—ç—à–∞: Ctrl+Shift+R
```

**–û—à–∏–±–∫–∞ 500 –æ—Ç API**
```bash
docker compose logs backend --tail=50
```

**–û—à–∏–±–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (No module named 'cryptography' –∏–ª–∏ 'paramiko')**

–ü–∞–∫–µ—Ç—ã –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å –ø—Ä–∏ —Å–±–æ—Ä–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞). –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:
```bash
docker compose exec backend pip install cryptography paramiko
docker compose restart backend
```

**–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**
```bash
cd /opt/support-portal/frontend
rm -rf node_modules
npm install
npm run build
```

**–ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –±–∞–∑–µ**
```bash
docker compose exec backend python manage.py shell -c "
from apps.clients.models import Client
from django.utils import timezone
from datetime import timedelta
old = Client.objects.filter(is_draft=True, created_at__lt=timezone.now()-timedelta(days=1))
print(f'–ù–∞–π–¥–µ–Ω–æ: {old.count()}')
for c in old:
    for f in c.files.all(): f.file.delete(); f.delete()
    c.delete()
print('–ì–æ—Ç–æ–≤–æ')
"
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–§–∞–π–ª `.env` **–Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ git**. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `.gitignore` —Å–æ–¥–µ—Ä–∂–∏—Ç:

```
.env
media/
*.pyc
__pycache__/
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS

```bash
apt install certbot python3-certbot-nginx -y
docker compose stop nginx
certbot certonly --standalone -d –≤–∞—à-–¥–æ–º–µ–Ω.ru
# –û–±–Ω–æ–≤–∏—Ç–µ nginx/default.conf ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –±–ª–æ–∫ SSL
docker compose start nginx
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
support-portal/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ accounts/             # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ä–æ–ª–∏, JWT
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/       # 0001_initial, 0002_user_birthday, 0003_update_role_choices, 0004_merge
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ clients/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ models.py         # Client, Provider, ClientFile, SystemSettings, DutySchedule, CustomHoliday
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ views.py          # API, SSH, —ç–∫—Å–ø–æ—Ä—Ç Excel, –ø–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–µ–∂—É—Ä—Å—Ç–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ serializers.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ settings_views.py # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SSH –∏ SMTP, —Ç–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ email
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ config/settings.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientsPage.jsx       # –°–ø–∏—Å–æ–∫ + —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ + —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É + —ç–∫—Å–ø–æ—Ä—Ç Excel
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientDetailPage.jsx  # –ö–∞—Ä—Ç–æ—á–∫–∞: –û—Å–Ω–æ–≤–Ω–æ–µ/–°–µ—Ç—å/–ü—Ä–æ–≤–∞–π–¥–µ—Ä 1/–ü—Ä–æ–≤–∞–π–¥–µ—Ä 2
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ClientFormPage.jsx    # –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CalendarPage.jsx      # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–µ–∂—É—Ä—Å—Ç–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsPage.jsx      # SSH + SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UsersPage.jsx         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ + –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProvidersPage.jsx
‚îÇ   ‚îú‚îÄ‚îÄ src/store/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authStore.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ themeStore.js         # –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (localStorage)
‚îÇ   ‚îî‚îÄ‚îÄ src/api/index.js
‚îú‚îÄ‚îÄ nginx/default.conf
‚îú‚îÄ‚îÄ media/                        # –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ deploy-frontend.sh
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env                          # –ù–µ –≤ git!
‚îî‚îÄ‚îÄ .env.example
```

---

## Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)

| –ü–∞–∫–µ—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|-----------|
| django | –û—Å–Ω–æ–≤–Ω–æ–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ |
| djangorestframework | REST API |
| djangorestframework-simplejwt | JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| psycopg2-binary | –î—Ä–∞–π–≤–µ—Ä PostgreSQL |
| django-cors-headers | CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ |
| django-filter | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ API |
| python-dotenv | –ó–∞–≥—Ä—É–∑–∫–∞ .env —Ñ–∞–π–ª–∞ |
| cryptography | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π SSH –∏ SMTP (Fernet) |
| paramiko | SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ú–∏–∫—Ä–æ—Ç–∏–∫—É |
| openpyxl | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ |
| gunicorn | WSGI-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ |
| Pillow | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |